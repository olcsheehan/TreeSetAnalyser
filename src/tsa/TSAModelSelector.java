package tsa;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import beast.app.util.Application;
import beast.core.Input;
import beast.core.Operator;
import beast.core.Runnable;
import beast.core.State;
import beast.core.parameter.IntegerParameter;
import beast.core.parameter.RealParameter;
import beast.core.util.CompoundDistribution;
import beast.core.util.Log;
import beast.evolution.alignment.Alignment;
import beast.evolution.alignment.Sequence;
import beast.evolution.branchratemodel.StrictClockModel;
import beast.evolution.datatype.Binary;
import beast.evolution.likelihood.AncestralStateTreeLikelihood;
import beast.evolution.operators.DeltaExchangeOperator;
import beast.evolution.operators.ScaleOperator;
import beast.evolution.sitemodel.SiteModel;
import beast.evolution.substitutionmodel.Frequencies;
import beast.gss.NS;
import beast.math.distributions.Prior;
import beast.util.TreeParser;
import tsa.correlatedcharacters.polycharacter.CompoundAlignment;
import tsa.correlatedcharacters.polycharacter.CorrelatedSubstitutionModel;
import tsa.parameterclone.helpers.RescaledDirichlet;
import tsa.parameterclone.selector.Selector;

public class TSAModelSelector extends Runnable {
	public Input<Integer> particleCountInput = new Input<>("particleCount", "number of particles (default 100)", 100);
	public Input<Integer> subChainLengthInput = new Input<>("subChainLength", "number of MCMC samples for each epoch (default 1000)", 1000);
	public Input<File> dataFileInput = new Input<>("file", "CSV file exported from DPLACE data", new File("dplace/dplace-societies-2017-02-21.csv"));
	public Input<Integer> thresholdV1Input = new Input<>("thresholdV1", "threshold value for first DPLACE feature. "
			+ "Values below it is interpreted as 0, values equal or above as 1", 1);
	public Input<Integer> thresholdV2Input = new Input<>("thresholdV2", "As thresholdV1 but for second DPLACE feature", 1);

	@Override
	public void initAndValidate() {
	}

	@Override
	public void run() throws Exception {
		
		Runnable NS = buildModel("0 1 2 3 4 5 6 7");
		NS.run();
	}
	
	
	private Runnable buildModel(String indexValues) throws IOException {
		String  newick = "((((((((((((((((((aaq:1.3067037544182234,mic:1.3067037544182234):4.208776647482255,(((crj:3.501768284919324,(crk:2.0526115035432615,csw:2.0526115035432615):1.4491567813760624):0.9390948195960149,nsk:4.440863104515339):0.013375213560599342,moe:4.454238318075938):1.0612420838245402):1.3170464543606588,(((arp:1.6596143143988729,ats:1.6596143143988729):2.6983806742868257,(bla:1.9957683522902754,chy:1.9957683522902752):2.362226636395423):1.5130226586901152,mez:5.8710176473758136):0.9615092088853237):0.06680911433890024,((((((ciw:2.2694896753876903,(ojc:1.207661246956549,ojg:1.207661246956549):1.0618284284311412):0.9021063918612815,(ojb:2.019425669655621,ojw:2.019425669655621):1.1521703975933506):0.7100669421884622,(ojs:2.754345710504098,otw:2.754345710504098):1.127317298933336):0.6922480194863492,pot:4.573911028923783):0.7774128897296979,(mia:2.444747433197464,sjw:2.444747433197464):2.9065764854560174):0.07162389941438985,(kic:2.655467546448106,sac:2.655467546448106):2.7674802716197653):1.4763881525321665):0.6137939176947915,(wiy:1.530044764981178,yur:1.530044764981178):5.983085123313652):5.533705743269786,(kee:4.648083964582544,kjq:4.648083964582544):8.39875166698207):2.383113188806192,((((chh:4.260729665224125,wac:4.260729665224125):8.805202107460198,((((((csi:0.26621927381184446,lmw:0.26621927381184446):0.3422042725178209,skd:0.6084235463296656):0.11848780609803689,csm:0.7269113524277023):0.13823535368983741,nsq:0.8651467061175396):1.2213096915873511,sis:2.086456397704891):5.959080741903756,csz:8.045537139608648):5.020394633075677):2.3394751832896556,((ncz:7.8457784694697885,yuc:7.8457784694697885):6.948964832121175,zkk:14.794743301590964):0.610663654383016):0.005221680829690101,((kla:3.332194362596891,yok:3.3321943625968906):3.464142460362626,(nez:3.586950449710236,((tqn:0.8428857672085135,uma:0.8428857672085135):0.7599597848268428,yak:1.6028455520353564):1.9841048976748799):3.2093863732492807):8.614291813844153):0.01932018356713705):0.014761819984148161,((acv:5.294114016033487,atw:5.294114016033487):7.321795623276998,((chr:4.310863442206484,(see:1.9078994873408288,wya:1.9078994873408288):2.4029639548656556):6.711527454689155,(kyh:4.60126368836053,sht:4.60126368836053):6.421127208535109):1.5935187424148456):2.8288010010444697):0.07184083313332401,((((((aes:7.127313574715042,sln:7.127313574715042):2.333639382933921,(((git:3.7050747491270952,tsi:3.7050747491270952):1.7328836104404686,(((has:1.617557843809699,(hei:0.823487370425386,kwk:0.823487370425386):0.794070473384313):1.075770419680387,myh:2.6933282634900864):0.6135133489031581,nuk:3.3068416123932445):2.1311167471743193):0.3524032432802535,qui:5.790361602847817):3.6705913548011457):0.036017554459220946,((blc:2.942932438403156,(cea:0.8018658118170283,qun:0.8018658118170283):2.1410666265861273):1.929263285231447,((((((clm:1.9124709610097579,(coo:1.5867987394478666,str:1.5867987394478669):0.325672221561891):0.4496523562133061,(ptw:1.7166593034594608,twa:1.7166593034594604):0.6454640137636032):0.07678687176844079,hur:2.438910188991505):0.08534266478473285,(slh:2.1676307040648464,squ:2.167630704064847):0.35662214971139106):1.6913554221774727,((col:2.015189783769929,((crd:1.0139610242662465,oka:1.0139610242662465):0.9241918703406362,fla:1.938152894606883):0.07703688916304596):0.7297792263778162,(lil:1.7926030407745783,(shs:0.8316678780711673,thp:0.8316678780711673):0.960935162703411):0.9523659693731665):1.4706392658059655):0.46476826912141345,til:4.680376545075124):0.19181917855947894):4.624774788473581):0.7296989074926827,kut:10.226669419600867):2.8087872799944673,(hax:5.489283921651866,hdn:5.489283921651866):7.546172777943467):0.4108064486164693,(((((((apj:1.3620506555634442,apl:1.3620506555634442):1.4441738068482335,((apm:1.4637073942350043,apw:1.4637073942350043):0.5447423709417227,nav:2.008449765176727):0.7977746972349506):0.926837723149669,apk:3.7330621855613466):4.271540745866824,(((((((bea:2.0172615476852114,(caf:0.7881800082059964,crx:0.7881800082059964):1.229081539479215):2.2598439448002368,(dgr:2.151950161610166,(scs:1.03420524218196,xsl:1.03420524218196):1.117744919428206):2.1251553308752817):0.43533800405858436,gwi:4.712443496544032):0.8172377509922946,tau:5.529681247536327):0.4803230072936602,((hoi:1.0156345424799254,koy:1.0156345424799254):2.3815051918783334,(ing:2.949603827510393,tfn:2.9496038275103924):0.4475359068478659):2.6128645204717285):0.40064678258883024,((chp:5.642050000054779,clc:5.642050000054779):0.591524683393648,(((haa:3.162617049806677,(kkz:1.1136145851025219,tht:1.1136145851025219):2.049002464704156):1.8234046460570221,ttm:4.986021695863699):0.7411872118322185,sek:5.727208907695918):0.5063657757525091):0.17707635397039034):0.12333591123020149,srs:6.5339869486490185):1.4706159827791527):0.8566047347705048,((ctc:2.762633454969095,((gce:1.2143228374285195,tuu:1.2143228374285195):1.3241846142653484,tol:2.538507451693868):0.2241260032752268):1.8861401893362073,((hup:1.5547934544094628,ktw:1.554793454409463):1.1550521253573356,(mvb:1.9521690628376065,wlk:1.9521690628376063):0.7576765169291921):1.9389280645385036):4.212434021893374):0.4943006393395635,eya:9.35550830553824):0.5668676481121206,tli:9.922375953650361):3.5238871945614427):2.0702883252764757):0.028865391562202802,(((ari:2.8192886003435285,wic:2.8192886003435285):0.4081754253188983,paw:3.2274640256624267):2.5596856473680676,cad:5.787149673030495):9.758267192019987):0.025631353450227934,(ale:8.674012989021493,(((ems:2.039668514365753,esu:2.039668514365753):2.0746480424386093,ess:4.114316556804362):3.6375798293641175,((esi:3.732144394881243,esk:3.732144394881243):3.1493301440345745,((ike:2.2882540522468,kal:2.2882540522468):0.9617506210301023,ikt:3.2500046732769023):3.6314698656389153):0.8704218472526621):0.9221166028530128):6.897035229479217):0.057866818608584225,was:15.628915037109294):0.24774228178477564,(((((((((((asb:1.371013292006333,lkt:1.3710132920063332):0.3528602895046624,dak:1.7238735815109953):1.7123616075472088,oma:3.436235189058204):1.1449259269096559,(iow:2.188295916241289,win:2.188295916241289):2.392865199726571):1.4377910841824404,((cro:1.4054851537168174,hid:1.4054851537168174):2.7406594417228813,mhq:4.146144595439699):1.8728076047106015):1.5060769302861283,chc:7.525029130436429):6.443958588198697,ynn:13.968987718635127):1.1685096473914385,(((cid:11.58495958246004,(((((coc:0.5012114961802971,dih:0.5012114961802971):0.4103397306165968,((mov:0.5022319864003227,yum:0.5022319864003225):0.23627996446631627,(mrc:0.6778179372314374,yuf:0.6778179372314374):0.06069401363520155):0.17303927593025503):0.09458975982661111,ppi:1.006140986623505):0.19502346099194012,klb:1.2011644476154453):9.948442650661947,crz:11.149607098277393):0.4353524841826477):1.9033108657521502,(((kju:0.2711172731039458,peq:0.2711172731039458):0.28796105704070096,pej:0.5590783301446467):0.4618689825490071,peb:1.0209473126936537):12.467323135518537):1.4310826090378779,(((((kio:3.9492738805974046,(tew:1.2080592421463858,tow:1.2080592421463858):2.7412146384510185):0.5075138272145452,(tix:1.4385941698275966,twf:1.4385941698275966):3.018193537984353):3.245827174272116,zun:7.702614882084066):4.8408265726840245,(wao:4.226994783164211,yuk:4.226994783164211):8.31644667160388):1.434798093833022,(nol:4.7977938370503885,(pwi:3.9391855220977274,wnw:3.9391855220977274):0.8586083149526611):9.180445711550725):0.9411135086489555):0.2181443087764965):0.18864304824165679,(((((((((chl:0.9172527584347486,cup:0.9172527584347486):1.3724094064344203,lui:2.289662164869169):1.1061424847349186,tub:3.3958046496040875):0.22043271440988876,ser:3.616237364013976):0.059419475159652624,xgf:3.675656839173629):0.9632795330651294,((com:2.8561561248382605,(par:1.7661201886563764,shh:1.7661201886563764):1.090035936181884):1.069939223962757,((mnr:1.817439425482166,pao:1.817439425482166):1.7647404199223593,(ute:1.7727747430737935,xaw:1.7727747430737935):1.809405102330732):0.343915503396492):0.7128410234377407):0.6325503618026431,hop:5.271486734041401):0.8154658989394221,((((hch:1.7953821317941545,(nci:0.8542273392601065,nhn:0.8542273392601065):0.9411547925340477):2.353948789295936,(opt:3.6222734106790524,yaq:3.6222734106790524):0.527057510411038):0.06901711519903131,tar:4.218348036289122):0.69193424877382,(ntp:2.4843181050632817,ood:2.4843181050632817):2.42596417999966):1.1766703479178817):7.665425625252834,tkm:13.752378258233657):1.5737621560345634):0.5150292577912925,((((cho:2.0471751774004816,cic:2.0471751774004816):3.5728643291780573,(mik:3.4298777996860936,mus:3.4298777996860936):2.1901617068924453):9.874643109553261,(((ctm:3.4561254332339293,tjm:3.4561254332339293):7.3319601263275915,miq:10.788085559561521):4.627818539675321,sei:15.415904099236842):0.07877851689495863):0.034627494462569075,xcw:15.52931011059437):0.3118595614651447):3.3899691877259386E-4,(mjd:4.945749558230591,(nmu:3.893385244815418,(nsz:3.54268018289508,vmv:3.54268018289508):0.3507050619203387):1.0523643134151728):10.895759110747695):0.035148649915782926):0.027509402170885267,(((((((((acs:2.324023265416572,(xav:1.7350502490200033,xer:1.7350502490200033):0.5889730163965685):1.8940732790603945,((apn:1.2326423896617358,ram:1.2326423896617358):2.9397110855769064,xok:4.1723534752386415):0.045743069238324274):0.9666669154590322,(kpj:3.266286442155057,kqq:3.266286442155057):1.9184770177809414):2.6675009769341695,(((awe:3.0887179831751377,myu:3.0887179831751377):0.6399174370481129,mav:3.72863542022325):2.1434402627645306,(((cod:2.377035811251003,tpn:2.377035811251003):2.8422408564082042,((kay:4.4460855661779695,(srq:1.3440212634887125,yuq:1.3440212634887125):3.102064302689257):0.3778108700453444,(taf:1.7255168645684456,tqb:1.7255168645684456):3.0983795716548688):0.39538023143589296):0.12352170742540114,(gui:2.4897392690903164,((gun:1.4592116362483356,guq:1.4592116362483356):0.5178481164436315,xet:1.977059752691967):0.5126795163983493):2.853059105994292):0.5292773079031727):1.9801887538823868):2.953204096386031,(((((((ako:1.4539502335792407,(car:1.2966572847979654,way:1.2966572847979654):0.1572929487812753):0.14075100792270256,mch:1.5947012415019433):1.1304589258173519,(bkq:0.5382022479355223,kui:0.5382022479355223):2.1869579193837727):0.3804210266671664,(((((aoc:0.3517684185103312,mbc:0.3517684185103312):0.48638717408239124,pbh:0.8381555925927223):0.5409600108904187,yar:1.3791156034831409):0.9975236520683943,yup:2.3766392555515354):0.42754043891990134,waw:2.804179694471437):0.3014014995150247):6.184351942401998,yae:9.28993313638846):0.4325663669473485,(((guu:0.6813814990514236,wca:0.6813814990514236):1.3376674466550849,shb:2.0190489457065084):2.1693601526167887,xsu:4.188409098323297):5.53409040501251):1.0815917363972964,(((bor:3.4659847978800826,umo:3.4659847978800826):5.802646975757709,tpy:9.268631773637791):1.4095699627712648,((guh:5.523557035823065,tca:5.523557035823065):3.650510571078245,mbr:9.17406760690131):1.5041341295077455):0.12588950332404814):0.0013772935230953465):0.231427818080709,((((bzd:0.8436106237433189,(gym:0.6087433229941615,kvn:0.6087433229941615):0.2348673007491573):0.5728507383531504,((chb:0.5094103587699873,(mot:0.4060642568751413,tuf:0.4060642568751413):0.10334610189484611):0.39181825036072226,kog:0.9012286091307095):0.5152327529657599):6.896284250052034,((cub:0.8860249430088799,tuo:0.8860249430088799):4.168053603114842,huu:5.054078546123721):3.258667066024782):0.9104934405459311,(pid:6.128778210396929,wba:6.128778210396929):3.0944608422975053):1.8136572986424735):0.2159788555578288,((((alc:2.0076901869504127,yag:2.0076901869504127):0.9616972973360887,(ona:2.2125959023384514,teh:2.2125959023384514):0.75679158194805):2.0922118175963824,arn:5.061599301882883):5.384534575726422,((((axb:2.101762174321602,tob:2.101762174321602):1.3576774131623086,kbc:3.459439587483911):4.80361861482738,ure:8.263058202311292):2.112995191573207,((((ayr:8.8523104117612,(ceg:7.134905077737794,((crq:0.6787818308896555,wlv:0.6787818308896555):4.65155118483581,leg:5.330333015725466):1.804572062012328):1.7174053340234057):0.22969453376398796,nab:9.082004945525188):1.1624279052479878,quz:10.244432850773176):0.06783687362589674,(cax:2.6098605584897268,gta:2.6098605584897268):7.702409165909346):0.06378366948542613):0.0700804837248068):0.8067413292854315):0.34147176927666045,((((((amc:0.5654384516892887,cao:0.5654384516892887):0.2490067004085621,shp:0.8144451520978508):3.4990725077054483,yad:4.313517659803299):5.335921904703894,jiv:9.649439564507194):0.501773380368153,(((((arw:3.0457169052589284,tnq:3.0457169052589284):0.07500860240498541,(cab:1.5986263779355459,(guc:0.7841204437607193,pbg:0.7841204437607193):0.8145059341748262):1.5220991297283681):0.618968175889854,((kpc:1.125033986299485,pio:1.125033986299485):1.5169265353433092,wap:2.6419605216427944):1.0977331619109734):0.4612624114061159,plu:4.200956094959883):0.42779195028352035,(((cni:1.2497745494955665,pib:1.2497745494955665):1.0998547206133698,ter:2.3496292701089363):0.6247810481338614,pab:2.9744103182427977):1.6543377270006063):5.5224648996319425):1.2072148783093013,(cbi:8.558623420576954,(emp:5.97530621188889,pbb:5.97530621188889):2.5833172086880625):2.7998044026076947):0.23591915298674948):3.422609138173021,((((((((((caa:1.191239914984408,tzh:1.191239914984408):1.6328312980150805,jac:2.8240712129994887):0.7107734454723071,(((cak:0.6262254304161761,quc:0.6262254304161761):0.7031395643860326,poc:1.3293649948022088):1.0039280762482587,mam:2.3332930710504676):1.2015515874213283):1.1717348245632104,(lac:1.758755125505155,yua:1.758755125505155):2.9478243575298517):1.3862125397049372,hus:6.0927920227399435):4.115893914201209,chd:10.208685936941153):0.5690099560508166,((csa:3.6362109328310055,(ote:2.1883263643308566,pei:2.1883263643308566):1.447884568500149):2.491672068851974,((mau:1.383028237942397,zpu:1.383028237942397):1.0442897241940856,mxa:2.427317962136483):3.7005650395464964):4.64981289130899):1.8098878401410765,(huv:11.0033578475315,(tos:9.344213154179428,tsz:9.34421315417943):1.6591446933520704):1.5842258856015459):1.7485537379783533,(jic:11.809645147146558,(mir:4.255016980366932,poi:4.255016980366932):7.554628166779625):2.526492323964842):0.11232633751169452,len:14.448463808623094):0.5684923057213247):0.8872106067205365):12.838038574219974,((ckt:2.3329475793445136,kpy:2.3329475793445136):4.383447236586489,itl:6.716394815931003):22.025810479353925):21.246104168348904,(((((((aar:4.894326741282976,((((arv:1.1622374153541484,dsh:1.1622374153541484):1.1306014547303764,som:2.2928388700845246):0.626481707452919,((gax:1.6509248944111388,gaz:1.6509248944111388):0.49610686136327153,kxc:2.1470317557744103):0.7722888217630333):0.5886174737710048,tsb:3.507938051308449):1.3863886899745275):0.6503965142041475,((bji:1.278815461908196,sid:1.2788154619081957):1.6552541481780905,drs:2.9340696100862864):2.6106536454008373):2.7459377549294963,(ahg:7.534537426299235,(gow:2.0553378927205586,irk:2.0553378927205586):5.479199533578678):0.7561235841173843):0.23407385072439624,(bej:4.007912546455606,byn:4.007912546455606):4.51682231468541):5.1716474069253575,((((((((acm:5.044091938358536,(ars:3.408655751754036,ayn:3.408655751754036):1.6354361866044997):0.4889480587864625,(ajp:1.3902485036713819,apc:1.3902485036713819):4.1427914934736165):3.7616833433433223,((aec:6.590626308285241,(apd:4.301917893893494,shu:4.301917893893494):2.2887084143917473):0.4210407159018237,arz:7.011667024187065):2.2830563163012556):0.46972287352496167,((((aeb:2.956638041223902,arq:2.9566380412239024):2.6464078590777587,ayl:5.603045900301661):0.09763750979189378,ary:5.700683410093554):0.11028830596212114,mey:5.8109717160556755):3.9534744979576066):0.7015479980238908,heb:10.465994212037174):0.9751852556516329,((amh:1.8050840470840455,sgw:1.8050840470840455):2.56249392014618,(tig:2.2949456551708973,tir:2.2949456551708973):2.072632312059328):7.07360150045858):1.3211258802966377,(((((anc:2.216589275976327,((bol:0.4991072752662966,kai:0.4991072752662966):0.6993108982660994,kna:1.198418173532396):1.0181711024439313):0.6204336610103796,hau:2.8370229369867066):1.1346614727129625,(bux:1.284309508528728,ngi:1.284309508528728):2.687374901170941):1.593673235826326,mcn:5.565357645525995):0.5441292052806794,((((bcy:2.692266881129037,bta:2.692266881129037):0.27710220249696604,gde:2.969369083626003):0.3984108016225756,((hwo:1.0576226045308734,ttr:1.0576226045308734):1.7072051217250763,maf:2.76482772625595):0.6029521589926286):0.9595288385596636,(((bdm:1.217278006990003,mug:1.217278006990003):1.8526057938427538,(kot:2.1352192793525644,kvj:2.1352192793525644):0.9346645214801925):0.340620669436313,(((bwr:1.048737786061744,mrt:1.048737786061744):0.5592448021486585,pbi:1.6079825882104024):1.291760228700284,giz:2.8997428169106865):0.5107616533583834):0.9168042535391723):1.7821781269984323):6.652818497178769):0.22145548643814728,(((((gnc:3.25402808965674,zen:3.25402808965674):3.1458720216459852,(kab:3.69652423362256,(shi:2.038535491619574,tzm:2.038535491619574):1.6579887420029862):2.703375877680165):1.0523238066675793,((taq:2.6242333453289604,ttq:2.6242333453289604):1.540243889061732,thv:4.164477234390692):3.287746683579612):0.3360763740136514,((mzb:1.7173433377666392,tia:1.7173433377666392):2.4125977731715738,(rif:3.185124448619654,shy:3.1851244486196544):0.944816662318559):3.6583591810457428):1.2724240937747648,siz:9.060724385758721):3.9230364486648703):0.7126214336427825):15.021638520759366,((((abk:2.821770441969087,kbd:2.821770441969087):9.051021347265847,bsk:11.872791789234935):4.21816983400554,(((((aln:2.772340408432785,ell:2.772340408432785):3.9537328703075145,((((((((ben:0.7980531957497901,ccp:0.7980531957497903):0.5841885315400972,ori:1.3822417272898873):0.8812200604262139,(sin:0.46468725923152876,ved:0.46468725923152876):1.7987745284845724):0.04195322299106996,hne:2.3054150107071716):0.5543054688768976,((bfz:2.6266180518508424,(bhb:1.1087636082911125,guj:1.1087636082911128):1.5178544435597299):0.09273113476448236,(bho:0.8872544282125387,mai:0.8872544282125387):1.8320947584027865):0.14037129296874395):0.27928995304340765,(kas:2.24148187251498,((mvy:1.0301980681565837,scl:1.0301980681565837):1.0312234316596411,(pan:1.2026680784446067,snd:1.2026680784446067):0.8587534213716184):0.18006037269875508):0.8975285601124963):0.5392312652019053,xvi:3.6782416978293817):1.0613218814222218,(((bgp:1.6611062927760056,ckb:1.6611062927760056):1.1009155011767644,((bqi:1.2042795811083031,pes:1.2042795811083031):0.863861575213889,haz:2.0681411563221923):0.6938806376305777):0.7825536491840235,(oss:2.8783166995777365,pbu:2.8783166995777365):0.666258743559057):1.19498813611481):1.9865096994886962):0.6376337715757181,((((((bel:0.8809116691723325,ukr:0.8809116691723325):0.3608673456080398,rus:1.241779014780372):0.11676518933112767,ces:1.3585442041115001):0.21770519011171485,(bul:0.4807095403897791,srp:0.4807095403897791):1.0955398538334358):1.408779735894904,(lav:1.3484580785164806,lit:1.3484580785164806):1.6365710516016383):2.773640003602538,(((eng:1.5599366776336032,nld:1.5599366776336032):0.31307070883500265,isl:1.873007386468606):2.821243076911674,(((((fra:0.6842549568672669,wln:0.6842549568672669):0.8459625945320122,(por:0.5662821836796373,spa:0.5662821836796373):0.9639353677196415):0.21963536088737312,nap:1.749852912286652):0.18398601970343842,ron:1.9338389319900906):2.3141301055850296,gle:4.24796903757512):0.44628142580515995):1.0644186703403768):1.6050379165953608):0.4084782241209455,hye:7.772185274436963):3.0608096789480346,(che:8.364209933929178,(kat:4.668764443065386,sva:4.668764443065386):3.6954454908637917):2.4687850194558205):5.257966669855476):1.4277011692230417,eus:17.518662792463516):11.199357996362224):19.73384980177312,(((((((((((((((abs:1.3529721756518343,(iba:1.0906145972439503,((kvb:0.44300098800412013,zlm:0.4430009880041201):0.17310820555665324,(min:0.3678831328128128,zmi:0.3678831328128128):0.24822606074796028):0.47450540368317706):0.262357578407884):0.5985878708896566,(cjm:0.7161119289459791,rad:0.7161119289459791):1.2354481175955119):0.40282678374906333,(ban:0.6527106442161053,smw:0.6527106442161053):1.7016761860744487):0.41114625652717196,((bbc:0.5501457609024385,mwv:0.5501457609024385):0.9006902344245862,mwt:1.4508359953270247):1.3146970914907012):1.3699157741938306,((((((((((((adz:0.6910478474789131,buk:0.6910478474789131):0.9969514137558614,bpg:1.6879992612347745):0.47218917751424994,xsi:2.1601884387490244):0.7702080799178828,(mva:2.4736927578898085,woc:2.4736927578898085):0.45670376077709873):0.529759443645641,((((bwd:0.715866197104368,mox:0.715866197104368):0.9660966197793401,dob:1.6819628168837082):0.4379339176942463,swp:2.1198967345779542):0.9279033296660817,(kij:2.8078962612055323,(mek:2.367355824231626,meu:2.367355824231626):0.4405404369739063):0.23990380303850367):0.41235589806851225):0.08595643569614886,(((bnp:1.2556672549489043,nak:1.2556672549489043):1.895616935225282,(hrc:3.008872519533676,((sbb:1.6907818102907677,tpz:1.6907818102907677):1.1680489144187411,tva:2.8588307247095086):0.1500417948241668):0.14241167064051075):0.11868054748628909,(ncf:1.2908611092697624,wiv:1.2908611092697624):1.9791036283907129):0.2761476603482218):0.061131693455905634,((((aji:2.318402095575855,(erg:1.9909519730382166,nwi:1.9909519730382166):0.3274501225376387):0.6138344876059598,(((lmu:1.069918171261481,sns:1.0699181712614807):0.26337604768858247,(mmg:0.9796494914881655,sax:0.9796494914881656):0.3536447274618978):0.9967312428219814,mtt:2.330025461772045):0.6022111214097703):0.1806247985481746,dhv:3.1128613817299895):0.22597384722411196,((((apb:2.269898045998494,kwd:2.269898045998494):0.3877952049191338,lgu:2.657693250917627):0.40682771952578944,ntu:3.0645209704434166):0.24326523195061656,((((((((((cal:0.37221439900916314,mrl:0.37221439900916314):0.1266972034536934,chk:0.49891160246285643):0.09299306360704529,woe:0.5919046660699017):0.10437282757259458,uli:0.6962774936424962):0.44966449087629623,pon:1.1459419845187926):0.31492967848276154,mah:1.4608716630015544):0.44258812096452216,gil:1.9034597839660763):0.29260355250976144,kos:2.1960633364758375):0.39505629559970723,nau:2.5911196320755447):0.5807116913449435,(((fij:0.7240230149334087,llx:0.7240230149334087):1.2885018280436535,((((fud:1.424414437517306,(pkp:1.2832827573757128,wls:1.2832827573757128):0.14113168014159316):0.15711888638285876,((mnv:0.4297961748170028,tkp:0.42979617481700283):1.0935664292685954,((smo:0.6357555514795684,tkl:0.6357555514795684):0.48132828160643826,tvl:1.1170838330860067):0.40627877099959164):0.05817071981456645):0.07988949145273283,(((((haw:1.0409127157366158,(mri:1.0318351248430018,((pmt:0.5000261492571157,tah:0.5000261492571157):0.5088226530774239,((pnh:0.35377710454833994,rkh:0.35377710454833994):0.5335265112910175,rar:0.8873036158393575):0.12154518649518209):0.022986322508461887):0.009077590893614262):0.08118262261091513,(mrq:0.6214893653006635,mrv:0.6214893653006635):0.5006059730468675):0.018342894391614184,rap:1.1404382327391451):0.44037670005917007,ojv:1.5808149327983152):0.06845876011296226,kpg:1.6492736929112775):0.012149122441619697):0.008268699559541348,(niu:0.7349604046148045,ton:0.7349604046148045):0.9347311102976344):0.34283332806462363):0.632228534781115,rtm:2.6447533777581773):0.5270779456623114):0.13595487897354497):0.03104902656006825):0.2684088625105012):0.039935444124916675,(((lle:1.4292501600002756,wuv:1.4292501600002756):0.22265056351261325,ttv:1.651900723512889):1.165097066412505,yap:2.816997789925394):0.8301817456641256):0.08351424723078171,wrp:3.7306937828203015):0.12521865229554985,(((aol:2.7181882050832753,kei:2.7181882050832753):0.5237476938163077,((kod:2.316393398869969,xbr:2.316393398869969):0.5452589743327345,slp:2.861652373202704):0.38028352569687884):0.06348964121936751,(slu:3.2369581225973763,(tet:2.8024160614136338,twu:2.8024160614136338):0.4345420611837425):0.06846741752157426):0.5504868949969008):0.04613168305705839,(cha:2.052929528970764,pau:2.052929528970764):1.8491145892021454):0.09906615736806446,(mak:0.8598163203236198,sda:0.8598163203236198):3.141293955217354):0.13433858547058275):0.02679107643900558,(((dtp:1.7848631571628593,(pna:1.6949142986130274,sge:1.6949142986130277):0.08994885854983181):1.356763306692994,jav:3.1416264638558538):0.44948153352453746,(((msh:0.1496938292341904,tdx:0.1496938292341904):0.3513559474570423,(plt:0.33034217766481017,(skg:0.2553672973818858,tkg:0.2553672973818858):0.07497488028292443):0.1707075990264224):2.0781227297011045,ssb:2.579172506392337):1.0119354909880536):0.5711319400701713):0.007944153873126858,((((agt:1.6492273085622027,(apf:1.4446744301288803,dgc:1.4446744301288803):0.2045528784333226):0.14837766925351237,((ifb:1.1995530150458449,(lbk:0.9013043277246513,xnn:0.9013043277246513):0.2982486873211937):0.3523059009615601,knb:1.551858916007405):0.24574606180831005):0.4270782500556385,(sbl:1.3043782520080696,tao:1.3043782520080696):0.9203049758632842):0.6651482222487934,((((akl:1.447381966301202,ceb:1.447381966301202):0.5046319424819352,(hnn:1.4172019310893949,(plw:0.7015322324546329,tbw:0.7015322324546329):0.7156696986347619):0.5348119776937421):0.24432553388522504,(mbb:1.7082859496110314,syb:1.7082859496110314):0.4880534930573306):0.37719914089410445,bpr:2.573538583562467):0.3162928665576805):1.280352641203542):0.7207875246021826,pwn:4.890971615925872):0.502488506483262,(ami:2.0305126895458963,(bnn:1.4950317648457796,tay:1.4950317648457796):0.5354809247001164):3.362947432863238):0.298474925751127,pyu:5.691935048160261):6.583019713635248,((((((biy:1.0294881902178565,(hoc:0.584676530376669,unr:0.584676530376669):0.44481165984118753):0.808509806468185,sat:1.8379979966860416):3.0222311799605426,(kha:2.475384732799237,((lbn:0.7511395393882571,lcp:0.7511395393882571):0.6838293058007276,pll:1.4349688451889848):1.040415887610252):2.384844443847347):0.9412311104696567,(((caq:3.5815472637950623,kns:3.5815472637950623):0.5382705992775665,sea:4.119817863072629):0.7247079836077006,khm:4.844525846680329):0.9569344404359112):0.17916870999969525,(mng:4.739991961693419,(mra:3.4443953517299737,(mtq:2.744381620226104,vie:2.7443816202261044):0.7000137315038697):1.2955966099634453):1.240637035422517):1.5697600605411948,(lic:2.6192883120425328,tha:2.6192883120425328):4.931100745614598):4.724565704138378):0.9278224692703851,(((((((adi:3.0558171850340576,(bod:0.8660344331128326,xsr:0.8660344331128326):2.1897827519212254):0.6084045718204925,(lep:1.7054423112142996,mgp:1.7054423112142996):1.9587794456402507):1.6442704961473869,((grt:0.9042614998019031,xac:0.9042614998019031):1.869454501204003,kac:2.7737160010059063):2.534776251996031):0.2800109504288182,((ahk:2.0431060927936713,iii:2.0431060927936713):1.4959822185374612,(mya:1.368580464346973,rki:1.368580464346973):2.17050784698416):2.0494148920996227):0.6530989250124106,pwo:6.241602128443166):0.06457727768133648,((((aim:0.8747892950327406,lus:0.8747892950327406):0.6684540234120572,(mrh:0.8540271703595481,sez:0.8540271703595481):0.6892161480852496):0.8107273024574491,(pub:0.752951059881437,tcz:0.752951059881437):1.6010195610208098):1.5333809957410924,(mjw:2.586691620716918,((njh:1.3146349049531307,njo:1.3146349049531307):0.8588614076740322,(njm:1.3383051951229825,(nre:0.6773873930376181,nsm:0.6773873930376181):0.6609178020853645):0.83519111750418):0.413195308089755):1.3006599959264213):2.4188277894811634):1.1643835402324516,(bca:6.4103093119682555,((cmn:2.1023716767794607,wuu:2.1023716767794607):1.3060569455074345,(nan:1.8336503420790065,yue:1.8336503420790065):1.5747782802078887):3.0018806896813603):1.0602536343886984):5.73221428470894):1.3490192333000781,(hea:2.438628552061814,mji:2.438628552061814):12.113167912304158):17.308663740883645,((jpn:2.773583482000834,((mvi:0.5433638314449333,rys:0.5433638314449333):0.6018680651898476,ryu:1.1452318966347808):1.628351585366053):1.6946217696443857,kor:4.4682052516452195):27.392254953604397):10.635188175979387,(((((ain:4.209462629080876,niv:4.209462629080876):25.57328371000478,(((evn:5.27068866786662,orh:5.27068866786662):1.6969628469259028,((((gld:2.076168342347292,(oaa:1.5210151696759089,ulc:1.521015169675909):0.555153172671383):1.269588479980181,(oac:1.7972473921115513,ude:1.7972473921115513):1.5485094302159217):2.16839695359304,neg:5.514153775920513):0.9671107078742045,mnc:6.4812644837947175):0.4863870309978049):3.1840339293256257,ykg:10.151685444118149):19.63106089496751):3.8315772486709427,(((bxr:4.796917910801835,(khk:2.2195468598672967,mvf:2.2195468598672967):2.5773710509345387):5.899343897348082,xal:10.696261808149918):1.8725835674241598,(dta:11.532974199856097,(mhj:8.457585526779372,mjg:8.457585526779372):3.0753886730767253):1.0358711757179808):21.045478212182523):0.1490776795233444,((((((((bak:0.44234858203038413,tat:0.44234858203038413):0.6204917478596188,kaz:1.0628403298900027):0.488029699412206,(kdr:1.039449475019508,kum:1.039449475019508):0.5114205542827006):0.15078456871881674,(qxq:1.0372118824361556,(tuk:0.8920252622930473,uzn:0.8920252622930472):0.14518662014310801):0.6644427155848702):0.08769423880700633,(gag:0.8074676550038703,tur:0.8074676550038703):0.9818811818241616):0.41946537569851317,sah:2.208814212526545):0.1700308153664114,chv:2.3788450278929565):8.259297333923204,(((((((((est:0.6017244588731488,liv:0.6017244588731487):0.6158663259126316,vot:1.2175907847857803):1.1127962239231766,((izh:1.6499274752178161,olo:1.649927475217816):0.49857544214102667,vep:2.148502917358843):0.1818840913501143):1.9074161992168497,(myv:4.220199512055355,smj:4.220199512055355):0.017603695870452185):0.08692890095530359,mhr:4.32473210888111):0.6524586410309166,((kca:1.4426840738305906,mns:1.4426840738305906):2.2947442159183993,udm:3.73742828974899):1.2397624601630368):0.023979934760754773,hun:5.001170684672782):0.9015513910966231,(nio:3.1309244923209216,(sel:2.0952856881161614,yrk:2.0952856881161614):1.0356388042047602):2.771797583448483):4.378897765252889,ket:10.281619841022295):0.3565225207938667):23.125258905463784):5.548837740484238,((anq:4.946052834238863,oon:4.946052834238863):15.214210920074304,((apq:10.046525363063886,sii:10.046525363063886):5.00522777744024,((((cde:2.315265998567108,mmk:2.315265998567108):0.8003276637964367,tel:3.1155936623635445):0.5246508225423967,kru:3.640244484905941):0.9959505114511136,((((daq:0.729506299574896,gno:0.7295062995748962):0.18519138252273315,kff:0.9146976820976292):0.9750604049916662,kxu:1.8897580870892956):1.6376636779626776,((((((kej:0.7105294142629092,pcf:0.7105294142629093):0.04125558268962315,mal:0.7517849969525323):0.5530581306377741,(mjp:0.5933166606991739,tam:0.5933166606991739):0.7115264668911324):0.31181093003379656,kfa:1.6166540576241029):0.2581520427748958,tcx:1.8748061003989989):0.6811114334435047,xuj:2.5559175338425035):0.9715042312094697):1.1087732313050815):10.41555814414707):5.108510613809042):19.151975253451017):3.1834093734648192):5.956222209369855):1.5364388730349745):6.889154810451359,((((((((abt:0.7614916763784364,ian:0.7614916763784364):11.90101406737542,ncm:12.662505743753858):3.0514529222450193,aon:15.713958665998877):1.4170207671554635,(kmo:14.986389611715266,(oro:12.621793871573352,siw:12.621793871573352):2.3645957401419118):2.144589821439075):0.8503008777155472,((fuy:12.912059681591904,iar:12.912059681591902):2.764670743778666,kjd:15.67673042537057):2.304549885499318):1.084992660514608,xtz:19.066272971384496):0.25527121429253086,(((((byz:15.220739277196014,((kbk:0.2922164544498553,kqi:0.2922164544498553):12.655955004177832,mgu:12.948171458627689):2.2725678185683265):0.8213084118088698,foi:16.042047689004885):0.07574239058268972,(((((dnt:3.933869407928098,ubu:3.933869407928098):1.1917465588344633,((enq:4.008859999342277,wnc:4.008859999342277):0.5648685708995922,okv:4.573728570241869):0.5518873965206925):0.1646620302245374,ekg:5.290277996987099):0.03909540155739055,for:5.329373398544489):0.11892308811706265,(((kgq:1.5389181882465335,kts:1.5389181882465333):0.3079488295240542,szb:1.8468670177705877):1.8775593228515577,snp:3.724426340622145):1.723870146039407):10.669493592926022):1.5347198761715894,((mrz:10.947729770967946,ulk:10.947729770967946):4.4333347234127025,tlb:15.381064494380649):2.2714454613785158):0.24064808647926483,yle:17.89315804223843):1.4283861434385976):0.41232409085944965,(((((((((((aer:0.5797775836435008,aly:0.5797775836435008):0.7960199750481601,axl:1.3757975586916609):1.3410819540785708,(wgu:1.3368974541161913,zku:1.3368974541161913):1.3799820586540406):1.8912192539851782,((dif:3.2532873129223883,rxw:3.2532873129223883):1.1572479931940545,(drl:3.258956366033193,unn:3.2589563660331926):1.1515789400832497):0.19756346063896757):0.3690877141419868,(dbl:3.480260417523273,(((((fln:0.42321177820495953,wim:0.4232117782049596):0.18512121118956348,ump:0.6083329893945231):0.4623098202733915,yyr:1.0706428096679146):2.0732094541339987,(gvn:3.0896870742986398,mwp:3.0896870742986398):0.05416518950327376):0.1813805205121426,wrg:3.325232784314056):0.15502763320921709):1.496926063374124):0.1322658926432947,((bdy:1.8004187208471953,(kld:0.8752577000184986,wyb:0.8752577000184986):0.9251610208286967):1.312818240700539,(nay:1.1471852073895918,tjw:1.1471852073895918):1.9660517541581428):1.996215411992957):0.4012877937790691,((((ddj:1.6430216121473897,wbp:1.6430216121473897):1.7618115498027815,(gbd:2.8495782181251608,(kdd:2.258703214244586,((mpj:0.8235742542766328,wbt:0.8235742542766328):1.3736196787833173,((ntj:0.8517030010620753,pjt:0.8517030010620753):0.6550518418281214,piu:1.5067548428901965):0.6904390901697535):0.061509281184636055):0.5908750038805746):0.5552549438250103):0.5540377859752357,(nju:2.3544631954184534,vka:2.3544631954184534):1.6044077525069533):0.6948888956269088,(djb:1.2784538168488684,duj:1.2784538168488684):3.3753060267034476):0.8569803237674449):1.832815394061237,(gyd:3.9802469363766875,lbz:3.9802469363766875):3.36330862500431):7.141308715776605,(wro:3.0257846722821338,wub:3.0257846722821338):11.45907960487547):0.9604159046554361,((aoi:4.9340088961743325,(gup:3.6815048374332506,nuy:3.6815048374332506):1.2525040587410818):7.123548133971422,gia:12.057557030145754):3.3877231516672843):3.3064672914705753,((((bvr:17.581885760213947,((kig:15.723505862577486,(kwe:0.8551964807503333,tmj:0.8551964807503333):14.868309381827153):1.6479452878440632,mpb:17.37145115042155):0.21043460979239725):0.22673691447013056,lrg:17.808622674684077):0.3179214091712481,gbu:18.126544083855325):0.1902360084548107,(mwf:10.794324900351363,tiw:10.794324900351361):7.522455191958773):0.43496738097347887):0.9821208032528617):37.143595997548715):16.075905980614436,((((((((((((((abr:0.5525359438601986,aka:0.5525359438601986):0.6320864631038839,(any:0.78601440628056,bci:0.78601440628056):0.39860800068352265):0.27606502088692353,abu:1.4606874278510058):0.6878665149013687,((ald:0.7036969525440686,avi:0.7036969525440686):0.7114254672041127,ati:1.4151224197481815):0.7334315230041932):0.6499172940128628,(ewe:1.5489729911697883,fon:1.5489729911697883):1.249498245595449):0.8199348558705251,akp:3.6184060926357624):0.7013609302823642,(ada:1.0673058623564722,gaa:1.0673058623564722):3.252461160561654):3.3529825065660672,fll:7.672749529484194):2.196563744156137,(((((((afo:2.2089951408139643,yer:2.208995140813964):0.43342048050164994,kcg:2.642415621315614):0.41043747773412376,ahs:3.052853099049738):0.6188265385777383,(bom:2.65117124129429,kad:2.65117124129429):1.0205083963331862):3.894256769965158,(((((((((((((asa:2.139089132120524,((((cwe:0.9251276478256856,ruf:0.9251276478256856):0.4577476490393486,(gog:1.0688661296547846,(ksb:0.9288126699729363,(ngp:0.40027857037019976,ziw:0.40027857037019976):0.5285340996027367):0.14005345968184812):0.3140091672102494):0.07409349388471154,kki:1.4569687907497455):0.630043672257683,(((dig:0.5665026284486977,(dug:0.3156852949223431,nyf:0.3156852949223431):0.2508173335263544):0.433959705464946,pkb:1.0004623339136438):0.5298094220526828,swh:1.5302717559663264):0.5567407070411021):0.05207666911309561):0.5973769885421807,((dav:0.6202682613268196,old:0.6202682613268196):1.7407782464037114,(((kam:0.5929533477015475,(kik:0.3383132510234446,soz:0.3383132510234446):0.254640096678103):0.49650089973735234,mer:1.0894542474389):1.1997495435390018,((nym:0.737005101555821,suk:0.737005101555821):0.4099572466882918,suw:1.1469623482441127):1.1422414427337892):0.07184271675262943):0.37541961293217385):0.40506021559343663,(((((bxk:1.1426904075544853,myx:1.1426904075544853):0.6542701326635714,(((((cgg:0.35040529469849824,nyn:0.35040529469849824):0.2565080946640867,(nyo:0.355274712019677,ttj:0.355274712019677):0.251638677342908):0.21454256547226458,hay:0.8214559548348495):0.40574431489951646,(ked:0.8071331482117109,zin:0.8071331482117109):0.420067121522655):0.18463836419847568,(lug:0.9344173667500398,xog:0.9344173667500398):0.477421267182802):0.3851219062852149):0.18417501656248403,(guz:1.6007225453082543,reg:1.6007225453082543):0.38041301147228634):0.3708415658118709,((((haq:0.6317619348110984,kin:0.6317619348110984):0.26097480537797535,run:0.8927367401890736):0.35710982044465056,(hke:0.5948369332614163,shr:0.5948369332614163):0.6550096273723078):0.5158229665134892,koo:1.7656695271472131):0.5863075954451982):0.19219500873392592,ida:2.5441721313263375):0.597354204929804):0.07499876796375737,(((bez:0.4229680017503424,heh:0.4229680017503424):0.7925887825071654,sbp:1.2155567842575077):0.27957143063146317,(mgs:0.6285122257259138,ngo:0.6285122257259138):0.866615989163057):1.7213968893309282):0.569275540829405,(((((((bdp:0.7995952165248873,(mwn:0.33378550584216704,piw:0.3337855058421671):0.46580971068272004):0.177965779303923,(fip:0.5515390196711439,mgr:0.5515390196711439):0.42602197615766646):0.2918594179730425,sbk:1.2694204138018526):0.46487367172532723,nyy:1.7342940855271798):0.5753199902335542,rim:2.309614075760734):1.2128453927929939,((kde:2.5978835720562223,yao:2.5978835720562223):0.5564851850684573,(lag:0.9156643075287736,mgz:0.9156643075287736):2.238704449595906):0.36809071142904815):0.14745037173411113,((((cce:1.5674984620206311,((((nde:0.46035863624927686,zul:0.4603586362492768):0.15459801682348923,xho:0.614956653072766):0.20140282334066895,ssw:0.8163594764134349):0.2077675143141594,tso:1.0241269907275945):0.5433714712930369):0.427130102474905,(((((loz:0.8023511846228072,sot:0.8023511846228072):0.1967115203249119,nso:0.999062704947719):0.12195649457780211,tsn:1.1210191995255212):0.5073770004677696,vmw:1.6283961999932908):0.1367756991738034,ven:1.765171899167094):0.22945666532844222):0.543020288816781,ndc:2.537648853312317):0.4433885023631383,(((ilb:0.5889690948533867,toi:0.5889690948533867):1.774134691148939,sna:2.3631037860023256):0.4343125692572052,(kdn:1.1764046406627142,(nya:1.108782481481268,seh:1.108782481481268):0.06762215918144632):1.6210117145968168):0.18362100041592466):0.6888724846123835):0.11589080476146485):0.15158793187799313,((((bem:0.5494727261888182,tap:0.5494727261888182):0.6537788108745567,(lam:0.32184436473552464,leb:0.32184436473552464):0.8814071723278503):0.8775577642876133,tum:2.080809301350988):0.3761326087060515,tog:2.4569419100570395):1.4804466668702574):0.27549615776517067,((byi:0.9199453748607771,sod:0.9199453748607771):1.284883670791726,lea:2.2048290456525033):2.008055689039965):0.7792864723032364,(((bcp:2.0213376628753004,((((bip:0.27751501307939225,kzy:0.27751501307939225):0.4551547263246257,kmw:0.7326697394040179):0.5083744683596867,brf:1.2410442077637047):0.3217735331290166,rwm:1.5628177408927215):0.45851992198257885):0.9464692100922854,buu:2.9678068729675857):1.6195572455710128,((((((bdu:1.5666873796639156,bri:1.5666873796639156):0.8246283207222298,(bnm:1.9456305049561962,dua:1.9456305049561962):0.4456851954299488):0.8196573729191186,(bkh:2.892903775674481,fan:2.892903775674481):0.3180692976307826):0.05837550096331112,ksf:3.269348574268575):0.21187767588456463,(((bmw:2.106907378486419,nmg:2.106907378486419):0.2007520663432687,njy:2.307659444829688):0.8865580545367346,(koq:2.722302200523418,(mye:1.6786693497216747,tsv:1.6786693497216747):1.0436328508017432):0.47191529884300465):0.28700875078671695):0.5929436892565665,(bvb:1.749890715717294,tvu:1.749890715717294):2.324279223692412):0.5131941791288925):0.40480708845710556):0.011864029854031344,((axk:4.23439076367362,((((((cjk:1.1195539831003003,lue:1.1195539831003003):0.5023086175507203,(lch:1.0719991998510303,lum:1.0719991998510303):0.5498634007999903):0.4979063691949086,lun:2.119768969845929):0.5279736468370873,((her:0.9254900913876756,ndo:0.9254900913876757):0.726653044750844,((khu:0.5477401221062507,umb:0.5477401221062507):0.3352828431588063,nyk:0.883022965265057):0.7691201708734628):0.9955994805444965):0.9560984564539026,smd:3.6038410731369193):0.5089674575916607,((((diz:0.41731152617626427,yns:0.41731152617626427):0.9679505581425867,(soo:0.5563774183855636,zmp:0.5563774183855636):0.8288846659332871):1.057870519187216,((kwy:0.9149766236036342,sdj:0.9149766236036342):0.6546891890003917,(sub:1.0188470105522,yaf:1.0188470105522):0.5508188020518261):0.873466790902041):1.5297183364672269,(ebo:3.0919175100281717,yom:3.091917510028172):0.8809334299451219):0.1399575907552859):0.12158223294504023):0.2214863162409042,((((bja:0.7131155822851843,lin:0.7131155822851843):1.0512216913986676,(lse:0.674405384866582,ngc:0.674405384866582):1.08993188881727):1.1724712322947262,(((((buf:0.25634589764752225,lel:0.25634589764752225):0.502722242450917,skt:0.7590681400984391):0.5495895433346423,(kel:0.7234716138014242,tll:0.7234716138014241):0.5851860696316573):0.5904265315153074,ksv:1.8990842149483886):0.40425388541264473,(lal:0.8845324730817148,lol:0.8845324730817148):1.4188056272793188):0.6334704056175444):1.4206997357694866,((((khy:0.4166631658305381,pof:0.4166631658305381):0.8292946589194599,zms:1.245957824749998):2.1439864010517735,((mdp:0.38428137965758813,shc:0.38428137965758813):0.7527024707830916,pem:1.1369838504406797):2.2529603753610914):0.8333435689903648,((((kqn:0.46693153086917594,sng:0.46693153086917594):0.44608350136806857,lub:0.9130150322372445):0.6366586194315771,lua:1.5496736516688214):0.7442491336784574,sop:2.2939227853472786):1.9293650094448576):0.13422044695592827):0.09836883816645958):0.5481581569352114):1.013102437697948,(bky:3.080384352857947,ken:3.080384352857947):2.9367533216897366):0.4528626263877662,((((((bax:0.43137068161125935,mhk:0.43137068161125935):0.39441806639406257,lmp:0.8257887480053219):0.09247898402586507,bfd:0.918267732031187):0.20715279456958158,(bko:0.4930714576617384,fmp:0.4930714576617384):0.6323490689390303):0.6094561660603395,mgo:1.7348766926611079):1.4228044932180732,((bfm:0.588592669400395,bkm:0.588592669400395):0.7830715848236217,lns:1.3716642542240167):1.7860169316551644):3.3123191150562685):0.20399435949451394,((brt:0.6179667745561913,tiv:0.6179667745561913):2.4136070502523794,etu:3.031573824808571):3.6424208356213925):0.303295065566072,((ccg:0.9058351131358634,tik:0.9058351131358634):3.071478149590667,((mcu:0.7872331641738223,vut:0.7872331641738223):0.7407401403904185,ndr:1.5279733045642405):2.44933995816229):2.999976463269505):0.5886466815965985):0.6602614730189744,idu:8.22619788061161):0.23151013766607953,((((((bin:0.49257954640196794,ets:0.49257954640196794):0.3355957858205862,iso:0.8281753322225542):1.1867439922029028,ibo:2.014919324425457):1.2663553807262526,((gby:0.46789639719586806,nup:0.46789639719586806):0.6768395877132809,igb:1.144735984909149):2.136538720242561):0.8855150517321921,(ich:1.9145860105853343,((jbu:0.4546012876483689,jib:0.4546012876483689):0.5717463056097278,nza:1.0263475932580968):0.8882384173272377):2.2522037462985676):2.7783662812177683,((((((bzw:1.1773577872204042,(cch:0.7758305432012274,((grh:0.230230329370075,krh:0.230230329370075):0.2881724161244368,nar:0.518402745494512):0.2574277977067152):0.40152724401917705):0.41421013302745013,cdr:1.5915679202478543):0.16652366441696698,dri:1.7580915846648213):0.8076000268400987,res:2.5656916115049198):3.463113787088619,((efi:0.7680013553946989,ibb:0.7680013553946989):1.4016311344593226,yaz:2.169632489854022):3.8591729087395175):0.7084547980781952,(((ife:0.4580335992971477,yor:0.4580335992971477):0.5483066561093051,its:1.006340255406453):0.8477724823565189,igl:1.854112737762972):4.883147458908762):0.2078958414299361):1.5125519801760179):1.4116052553626428):0.26268512456481474,((((((bbp:1.1244926756812956,zmz:1.1244926756812956):2.1281262643078604,((bkc:1.8115447153205757,nbm:1.8115447153205757):1.294690341224476,((brm:1.279662672804686,zne:1.279662672804686):1.353328104563456,ngb:2.6329907773681422):0.47324427917690937):0.14638388344410425):1.0160422695470395,(((((dow:0.9042232652664235,ver:0.9042232652664235):0.15149418721494212,ndi:1.0557174524813655):0.6583490529136906,mzm:1.7140665053950563):0.8977322068461608,tui:2.6117987122412174):0.44630362369559906,(lak:2.0152555889626433,(mdd:1.768721367269254,mua:1.7687213672692543):0.246534221693389):1.0428467469741731):1.2105588735993789):0.8791282349581486,(gya:2.048465654936147,mzv:2.048465654936147):3.099323789558197):2.886116586143661,((((((((((bfo:1.1186983213216686,(gur:0.3275275145161344,mos:0.3275275145161344):0.7911708068055343):0.39481227072385705,(biv:1.302504620844053,dga:1.3025046208440527):0.2110059712014727):0.13028304323341944,((dag:0.4849363594455819,maw:0.4849363594455819):0.4065043014086601,kus:0.8914406608542418):0.7523529744247031):0.3060101264041213,(bud:1.0514326364698101,((gux:0.32345416605853583,mfq:0.32345416605853583):0.20006709252927918,xon:0.5235212585878148):0.5279113778819954):0.8983711252132562):0.5020754538053755,tbz:2.451879215488442):0.5973057549665381,bwu:3.0491849704549803):0.9787232887078416,(lnu:1.305343715418807,vor:1.305343715418807):2.722564543744015):0.4785009165343421,((dos:2.794655611702955,(dya:0.9471195105105547,lob:0.9471195105105547):1.8475361011924):0.21903954581601193,(((kbp:0.5314570945015972,kdh:0.5314570945015972):0.6487250770740057,(sil:0.6527142460828838,vag:0.6527142460828838):0.5274679254927193):0.6398489542463373,(nnw:1.612817414540696,xsm:1.6128174145406957):0.20721371128124444):1.1936640316970264):1.4927140181781975):0.8981216064378454,nku:5.4045307821350095):1.4654080248080383,(myk:1.58338607179104,sef:1.58338607179104):5.286552735152008):1.1639672236949572):1.4794383943889002,((bet:0.951610255982075,bjw:0.951610255982075):2.002175683222711,((klu:1.017666531085484,krw:1.0176665310854842):0.40673480865514744,krn:1.4244013397406314):1.529384599464155):6.559558485822119):0.6186539731782403):0.9960725038251308,((((bab:1.8991749416908614,(bif:1.6557445845598442,wol:1.655744584559844):0.24343035713101746):3.6629074907438754,((bsc:1.5875154882968785,cou:1.5875154882968785):3.660474934949864,(((fub:3.530251415406753,(fuh:1.9716421113552116,fuv:1.9716421113552116):1.5586093040515412):0.40836159411040773,(fuc:0.8424914148882576,fuf:0.8424914148882576):3.0961215946289027):0.6818230587922232,srr:4.620436068309384):0.6275543549373586):0.31409200918799485):0.6469665317289399,(bjg:2.823351861110718,(ble:1.2656595868722882,(dyo:1.0569560129335873,pbo:1.0569560129335873):0.20870357393870087):1.5576922742384296):3.3856971030529595):0.841240819947692,(((bgo:0.7760916722712584,tem:0.7760916722712584):2.780102063823347,(bun:0.8806700753633521,kqs:0.8806700753633521):2.6755236607312534):0.30588480778329075,gol:3.862078543877896):3.188211240233473):4.077781117918907):7.399534934028093,(((((((((((bam:0.9173057304514345,dyu:0.9173057304514345):0.7389396111512208,kao:1.6562453416026555):0.10127028204007749,mlq:1.757515623642733):0.3448424433803783,knk:2.1023580670231112):0.45298793663979486,vai:2.5553460036629057):0.42449653976416757,(sus:0.9105871228475896,yal:0.9105871228475896):2.069255420579484):0.5524579314562823,(((bza:0.5153510421666809,men:0.5153510421666809):0.4480496457916787,tod:0.9634006879583598):0.7123157603205559,xpe:1.6757164482789155):1.8565840266044404):0.8006859898828194,(bbo:2.9795288454254147,(boz:2.0409421214473547,(bze:1.880390252603112,snk:1.880390252603112):0.16055186884424266):0.9385867239780601):1.3534576193407606):0.8605317326661899,((bib:1.1415019384174134,sbd:1.1415019384174134):2.1423757847936162,(((dnj:0.4969798773888314,neb:0.4969798773888314):0.2687419457621052,goa:0.7657218231509367):0.9501005560454929,ggu:1.7158223791964298):1.5680553440146):1.9096404742213355):2.373233635915856,(dbw:4.5421089355393836,(dje:0.7310159631757711,hmb:0.7310159631757711):3.811092972363612):3.024642897808837):8.436448324251504,ijn:16.003200157599725):2.5244056784586455):10.6435027221561,(((((((((((ach:1.8299135799945134,laj:1.8299135799945132):0.11098524149074973,(alz:0.8201795804926745,luo:0.8201795804926745):1.1207192409925886):1.089293965100657,mfz:3.03019278658592):0.24206474396280564,((anu:1.6130231507755066,shk:1.6130231507755066):0.34151336178572156,lkr:1.954536512561228):1.3177210179874976):0.9139188810203134,(dik:1.751229070295202,nus:1.751229070295202):2.434947341273837):1.626110716692402,(((bfa:2.210883384910434,(keo:1.0202900739581133,mqu:1.0202900739581133):1.1905933109523206):1.4615621689956986,((((kdj:0.8363523668764281,toq:0.836352366876428):0.34159517796937067,tuv:1.1779475448457986):0.6189233153382399,teo:1.7968708601840386):1.1693608375092206,((lot:2.0921425780391534,mas:2.0921425780391534):0.052366999642717627,saq:2.144509577681871):0.8217221200113882):0.7062138562128735):0.9540663032888248,(((((eyo:0.3460690660303231,niq:0.3460690660303231):0.43350010579279946,sgc:0.7795691718231222):1.0406607674350985,kpz:1.820229939258221):0.43502529695182646,(oki:1.9054753279416787,pko:1.9054753279416787):0.3497799082683688):1.1899864728510896,tcc:3.445241709061137):1.1812701481338204):1.1857752710664835):9.690480056957215,she:15.502767185218657):6.983552768103257,(((((((bst:0.8538122418873515,mdy:0.8538122418873513):0.1294973357645013,doz:0.9833095776518527):0.6187068812703128,kqy:1.6020164589221655):1.091279137125482,(kbr:0.6166258552306786,myo:0.6166258552306786):2.076669740816969):0.4317649526397407,jnj:3.125060548687388):10.77540278033108,(fuj:4.440896048974964,((kib:1.1727813149101887,otr:1.1727813149101887):1.4540616605859185,(mor:1.1306563539512262,tic:1.1306563539512262):1.496186621544881):1.8140530734788571):9.459567280043503):5.365275289846867,((((dil:0.8012659171157054,xnz:0.8012659171157054):0.332693918713884,mei:1.1339598358295893):10.718767680721124,(kgo:0.5976651302423198,tey:0.5976651302423198):11.255062386308392):1.6955338032827232,jle:13.548261319833436):5.7174772990318985):3.220581334456579):3.6787985295413357,((((((aiw:1.871116166908364,amf:1.871116166908364):2.014068150315526,dim:3.8851843172238905):5.9828589067849,(fvr:5.512065458128137,nyi:5.512065458128137):4.355977765880652):2.9126412635888546,((dzg:0.466045882228393,tuq:0.466045882228393):0.557069816202467,(kbl:0.5472492222931225,kby:0.5472492222931225):0.4758664761377377):11.757568789166784):0.06548896233051771,kun:12.846173449928163):0.11224034850393672,nrb:12.9584137984321):13.20670468443115):0.6410314720195842,((((did:0.840023711550286,suq:0.8400237115502861):0.34321768006298214,mym:1.183241391613268):14.80740007666124,hoz:15.990641468274509):0.9488326926275565,tbi:16.939474160902066):9.866675793980768):0.7386697711686843,((((bex:3.9677149295965712,(bmi:1.1200207514979785,mwm:1.1200207514979785):2.8476941780985925):0.27883864927068513,bot:4.246553578867256):1.3709684616109534,(((((efe:0.8058381357724946,les:0.8058381357724946):1.1025285812359673,mdi:1.908366717008462):2.2612928380837714,(lmi:0.9595949393306522,mdj:0.9595949393306522):3.210064615761581):0.12686141369133352,led:4.296520968783566):0.15851539014902638,((lgg:0.7474672670457143,log:0.7474672670457143):1.501442832321113,(mgd:1.9050198378493832,mhi:1.905019837849383):0.3438902615174442):2.2061262595657656):1.1624856815456166):4.002445774646006,xom:9.619967815124216):17.924851910927302):1.6262888321629525):3.3326054521092843,(((((((gwj:0.31100002835100043,nhr:0.31100002835100043):0.387504535035498,xuu:0.6985045633864984):0.32621565600006,tyu:1.0247202193865586):0.3383728964035173,(hgm:0.8023047423729024,naq:0.8023047423729024):0.5607883734171735):5.2730238719029705,(ktz:0.983258662509438,oun:0.983258662509438):5.652858325183608):2.350329418762218,(((ngh:2.180034897759362,xeg:2.180034897759362):1.304031926768999,xam:3.484066824528361):1.5100480352900303,nmn:4.994114859818391):3.9923315466368727):4.039542066011991,(hts:2.777894455044228,sad:2.777894455044228):10.248094017423028):19.4777255378565):40.44965624437587);";
		TreeParser tree = new TreeParser(null, newick, 0, false);

		Alignment data = processDataFile(tree.getTaxaNames());
		CompoundAlignment characters = new CompoundAlignment(data);
		
		
		
//		<run id="mcmc" spec="beast.gss.NS" chainLength="50000" preBurnin="5" particleCount="1" subChainLength="100">
		
// 		<state id="state" storeEvery="100">
//
//			<stateNode spec="beast.core.parameter.RealParameter" id="parameters"
//				lower="0.05">
//				1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
//			</stateNode>
		RealParameter parameters = new RealParameter("1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0");
//			<stateNode spec="beast.core.parameter.IntegerParameter" id="indices"
//				lower="0" upper="2">
//				0 1 2 3 4 5 6 7
//			</stateNode>
		IntegerParameter indices = new IntegerParameter(indexValues);
//			<stateNode spec="beast.core.parameter.IntegerParameter" id="sizes">
//				1 1 1 1 1 1 1 1
//			</stateNode>
		IntegerParameter sizes = new IntegerParameter("1 1 1 1 1 1 1 1");
//			<parameter id="frequencies" name="stateNode" lower="0" upper="1" value="0.25 0.25 0.25 0.25"/>
		RealParameter frequencies = new RealParameter("0.25 0.25 0.25 0.25");
		
//			<stateNode idref="clockRate.c:dplace"/>
		RealParameter clockRate = new RealParameter("0.5");
		clockRate.setUpper(1.0);
//		</state>
		
		State state = new State();
		state.initByName("stateNode", parameters,
				"stateNode", indices,
				"stateNode",sizes,
				"stateNode",frequencies,
				"stateNode",clockRate
				);

//		<operator id="DeltaExchanger" spec="DeltaExchangeOperator"
//			weight="1">
//			<parameter name="weightvector" idref="sizes" />
//			<parameter name="parameter" idref="parameters" />
//		</operator>
		
		DeltaExchangeOperator deltaExchanger = new DeltaExchangeOperator();
		deltaExchanger.initByName("weightvector", sizes, "parameter", parameters, "autoOptimize", false, "weight", 1.0);
//
//		<operator id="clockRateScaler.t:dna" spec="ScaleOperator" scaleFactor="0.9" parameter="@clockRate.c:dplace" weight="0.1"/>
		ScaleOperator clockRateScaler = new ScaleOperator();
		clockRateScaler.initByName("scaleFactor", 0.9, "weight", 0.1, "parameter", clockRate);
		
		List<Operator> operators = new ArrayList<>();
		operators.add(deltaExchanger);
		operators.add(clockRateScaler);
//
//		<distribution id="posterior" spec="CompoundDistribution">
//			<distribution id="prior" spec="CompoundDistribution">
//				<distribution id="rates_prior" spec="beast.math.distributions.Prior"
//					x="@parameters">
//					<distr spec="tsa.parameterclone.helpers.RescaledDirichlet">
//						<!-- Use a flat distribution -->
//						<parameter name="sizes" idref="sizes" />
//					</distr>
		RescaledDirichlet rescaledDirichlet = new RescaledDirichlet(sizes);
//				</distribution>
		Prior ratesPrior = new Prior();
		ratesPrior.initByName("x", parameters, "distr", rescaledDirichlet);
//			</distribution>
		CompoundDistribution prior = new CompoundDistribution();
		prior.initByName("distribution", prior);
//			<distribution id="likelihood" spec="CompoundDistribution">
//				<distribution id="treeSetLikelihood.dplace" spec="beast.evolution.likelihood.ThreadedTreeSetLikelihood" treeSetFile="/Users/remco/data/beast/global/scripts/gen/dplace-data/geo-rc/combined/geo-rc1197+almostnewwals+corrcals11.tree" burnin="0">
//					<treeLikelihood id="treelk" spec="AncestralStateTreeLikelihood" tree="@tree" data="@characters" tag="dplace">
//						<siteModel id="sitemodel" spec="SiteModel">
//							<substModel id="subst" spec="tsa.correlatedcharacters.polycharacter.CorrelatedSubstitutionModel" shape="2 2" alignment="@characters">
//								<rates id="actual_rates" spec="tsa.parameterclone.selector.Selector">
//									<groupings idref="indices" />
//									<parameters idref="parameters" />
//									<entry spec="beast.core.parameter.IntegerParameter">0 1 2 3 4 5 6 7 </entry>
//								</rates>
		Selector rates = new Selector(indices, parameters, new IntegerParameter("0 1 2 3 4 5 6 7"));
//								<frequencies name="frequencies" id="freqs"
//									spec="Frequencies" estimate="false" frequencies="@frequencies" />
		Frequencies freqs = new Frequencies();
		freqs.initByName("frequencies", frequencies);
//							</substModel>
		CorrelatedSubstitutionModel substModel = new CorrelatedSubstitutionModel(new IntegerParameter("2 2"), characters, rates, freqs);
//						</siteModel>
		SiteModel siteModel = new SiteModel();
		siteModel.initByName("substModel", substModel);
//						<branchRateModel id="StrictClockModel.c:dplace" spec="beast.evolution.branchratemodel.StrictClockModel">
//        		            <parameter id="clockRate.c:dplace" estimate="true" name="clock.rate" upper="1.0">0.5</parameter>
//	        	        </branchRateModel>
		StrictClockModel clockModel = new StrictClockModel();
		clockModel.initByName("clock.rate", clockRate);
//					</treeLikelihood>
		AncestralStateTreeLikelihood ancestralStateTreeLikelihood = new AncestralStateTreeLikelihood();
		ancestralStateTreeLikelihood.initByName("branchRateModel", clockModel, "tree", tree, "data", characters, "tag", "dplace", "siteModel", siteModel);
//				</distribution>
		//ThreadedTreeSetLikelihood treeLikelihood = new ThreadedTreeSetLikelihood(ancestralStateTreeLikelihood, treeSetFile, 0);
//			</distribution>
		CompoundDistribution likelihood = new CompoundDistribution();
		likelihood.initByName("distribution", ancestralStateTreeLikelihood);
//		</distribution>
		CompoundDistribution distribution = new CompoundDistribution();
		distribution.initByName("distribution", prior, "distribution", likelihood);
		
		
		NS ns = new NS(5000, 0, 1, 100, state, operators, distribution);
		return ns;
	}

	/** convert file exported from DPLACE into an Alignment 
	 * @param taxaNames **/
	private Alignment processDataFile(String[] taxaNames) throws IOException {
        BufferedReader fin = new BufferedReader(new FileReader(dataFileInput.get()));
        String str = null;
        // skip first line
        str = fin.readLine();
        
        // determine columns containing the data
        str = fin.readLine();
        String [] strs = str.split(",");
        int isoIndex = -1;
        int v1Input = -1;
        int v2Input = -1;
        for (int i = 0; i < strs.length; i++) {
        	if (strs[i].equals("ISO code")) {
        		if (isoIndex < 0) {
        			isoIndex = i;
        		} else {
        			fin.close();
        			throw new IllegalArgumentException("more than one ISO column found");
        		}
        	}
        	if (strs[i].startsWith("Code: ")) {
                if (v1Input < 0) {
                	v1Input = i;
                } else if (v2Input < 0) {
                	v2Input = i;
                } else {
        			fin.close();
        			throw new IllegalArgumentException("Found more than 2 Code: columns, but expected 2");
                }
        	}
        		
        }
        if (isoIndex < 0) {
			fin.close();
			throw new IllegalArgumentException("Could not find ISO column");
        }
        if (v1Input < 0) {
			fin.close();
			throw new IllegalArgumentException("Could not find any Code: column");
        }
        if (v2Input < 0) {
			fin.close();
			throw new IllegalArgumentException("Could only find one Code: column, but expected 2");
        }

        // get data out of columns
        Map<String,String> map = new LinkedHashMap<>(); 
        for (String iso : taxaNames) {
        	map.put(iso, "??");
        }
        while (fin.ready()) {
            str = fin.readLine();
            // remove qouted text
            str = str.replaceAll("\"[^\"]+\"", "");
            strs = str.split(",");
            String iso = strs[isoIndex];
            if (iso.length() > 0) {
	            String v1 = strs[v1Input];
	            v1 = normalise(v1, thresholdV1Input.get());
	            String v2 = strs[v2Input];
	            v2 = normalise(v2, thresholdV2Input.get());
	            String value = v1+v2;
	            if (map.containsKey(iso)) {
	            	String value2 = map.get(iso);
	            	if (!value.equals(value2) && !value2.equals("??")) {
	            		Log.warning("Ambiguous value for " + iso + " (" + value + " & " + value2 + "). Setting value to \"??\"");
	            		map.put(iso, "??");
	            	} else {
		            	map.put(iso, value);
	            	}
//	            } else {
//	            	map.put(iso, value);
	            }
            }
            
        }
        fin.close();

        // convert to Alignment
		Alignment data = new Alignment();
		data.userDataTypeInput.setValue(new Binary(), data);
		List<Sequence> seqs = data.sequenceInput.get();
		for (String iso : map.keySet()) {
			seqs.add(new Sequence(iso, map.get(iso)));
		}
		data.initAndValidate();
		
		return data;
	}

	private String normalise(String v, int threshold) {
		if (v.equals("NA")) {
			return "?";
		}
		try {
			int value = Integer.parseInt(v);
			if (value < threshold) {
				return "0";
			} else {
				return "1";
			}
		} catch (NumberFormatException e) {
			return "?";
		}
	}

	public static void main(String[] args) throws Exception {
		new Application(new TSAModelSelector(), "DPLACE Model Selector", args);
	}
	
}
